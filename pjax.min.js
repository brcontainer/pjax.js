/* Pjax.js 0.5.5 | Copyright (c) 2017 Guilherme Nascimento (brcontainer@yahoo.com.br) | Released under the MIT license */

!function(e,t,n){"use strict";function r(){return b?(clearTimeout(b),b=0,D.className="pjax-loader pjax-hide",void setTimeout(r,20)):(D||(D=e.createElement("div"),D.innerHTML='<div class="pjax-progress"></div>',e.body.appendChild(D)),D.className="pjax-loader pjax-start",void(b=setTimeout(function(){b=0,D.className+=" pjax-inload"},10)))}function a(){b&&clearTimeout(b),D.className+=" pjax-end",b=setTimeout(function(){b=0,D.className+=" pjax-hide"},1e3)}function o(e,t,r){[].slice.call(e.querySelectorAll(t)).forEach(r),r=n}function i(e){var t=[];return o(e,"[name]",function(e){e.name&&X.test(e.tagName)&&t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")}function l(e){if(C)return(new DOMParser).parseFromString(e,"text/html");var t=U.createHTMLDocument("");return/^\s*<(\!doctype|html)[^>]*>/i.test(e)?(t.documentElement.innerHTML=e,t.body&&t.head||(t=U.createHTMLDocument(""),t.write(e))):t.body.innerHTML=e,t}function c(t){var n,r,a,o=[],i=t.children;for(n=i.length-1;n>=0;n--)"TITLE"!==i[n].tagName&&o.push(i[n].outerHTML);for(i=e.head.children,n=i.length-1;n>=0;n--)"TITLE"===i[n].tagName||f(i[n],"resource")||(r=o.indexOf(i[n].outerHTML),-1===r?i[n].parentNode.removeChild(i[n]):o.splice(r,1));for(a=e.createElement("div"),a.innerHTML=o.join(""),i=a.children,n=i.length-1;n>=0;n--)f(i[n],"resource")||e.head.appendChild(i[n]);a=o=null}function s(e,t,n,r){if(w[e])for(var a=w[e],o=0;o<a.length;o++)a[o](t,n,r)}function u(e,t,n){return"function"==typeof t?(w[e]||(w[e]=[]),n?void(w[e]=w[e].filter(function(e){return e!==t})):void w[e].push(t)):void 0}function d(n,r,a,i){var u,d=l(r),f=d.title||"",p=a.containers,h=a.scrollLeft>0?+a.scrollLeft:t.scrollX||t.pageXOffset,m=a.scrollTop>0?+a.scrollTop:t.scrollY||t.pageYOffset;if(i){var v={pjaxUrl:n,pjaxData:r,pjaxConfig:a};1===i?H.pushState(v,f,n):2===i&&H.replaceState(v,f,n)}if(w.dom)return s("dom",n,d);a.updatehead&&d.head&&c(d.head),e.title=f;for(var x=p.length-1;x>=0;x--)u=d.body.querySelector(p[x]),u&&o(e,p[x],function(e){e.innerHTML=u.innerHTML});t.scrollTo(h,m),d=p=null}function f(e,t){var n,r=e.getAttribute("data-pjax-"+t);if("true"===r||"false"===r)return"true"===r;if(!isNaN(r))return parseFloat(r);if(/^\[[\s\S]+\]$|^\{[^:]+[:][\s\S]+\}$/.test(r))try{n=JSON.parse(r)}catch(a){}return n||r}function p(e){var t,n,r=JSON.parse(JSON.stringify(N)),a=["containers","updatecurrent","updatehead","loader","scroll-left","scroll-right","done","fail"];if(!e)return r;for(var o=a.length-1;o>=0;o--)t=a[o],n=f(e,t),n&&(t=t.toLowerCase().replace(/-([a-z])/g,function(e,t){return t.toUpperCase()}),r[t]=n);return r}function h(e,t,n,r,o,i){i&&d(e,i,t,n),s(i?"done":"fail",e),s("then",e),o&&new Function(o).call(r),t.loader&&a()}function m(){M&&M.abort()}function v(t){var n,r="_="+ +new Date;return O?(n=e.createElement("a"),n.href=t):n=new O(t),n.search+=(n.search?"&":"?")+r,t=n+"",n=null,t}function x(e,t,n,a,o){m();var i=p(a);if(s("initiate",e,i),i.loader&&r(),w.handler)return void s("handler",{url:e,state:t,method:n,element:a},i,h);var l={"X-PJAX-Container":i.containers.join(","),"X-PJAX-URL":e,"X-PJAX":"true"},c=N.proxy||e;N.nocache&&(c=v(e)),M=new XMLHttpRequest,M.open(n,c,!0);for(var u in l)M.setRequestHeader(u,l[u]);M.onreadystatechange=function(){if(4===this.readyState){var n=this.status;n>=200&&300>n||304===n?h(e,i,t,a,i.done,this.responseText):h(e,i,n,a,i.fail)}},M.send(o||"")}function S(e){if(0===e.button){var t,n,r=e.target;if(r.matches(N.linkSelector))t=r.href;else{for(;r=r.parentNode;){"A"===r.tagName&&(n=r);break}if(!n||!n.matches(N.linkSelector))return;r=n,t=r.href}L("GET",t,null,r,e)}}function j(e){var n,r,a,o=e.target;if(o.matches(N.formSelector)&&(a=String(o.method).toUpperCase(),"POST"!==a||t.FormData)){if(n=o.action,"POST"!==a||"multipart/form-data"!==o.enctype)r=i(o),"POST"!==a&&(n=n.replace(/\?.*/g,"")+"?",r&&(n+=r),r=null);else{if(!t.FormData)return;r=new FormData(o)}L(a,n,r,o,e)}}function L(e,n,r,a,o){return 0===n.indexOf(P+"/")||n===P?(o.preventDefault(),n===t.location+""&&"POST"!==e?void(N.updatecurrent&&x(n,2,e,a,r)):void x(n,1,e,a,r)):void 0}function T(e){e.state&&e.state.pjaxUrl&&(m(),d(e.state.pjaxUrl,e.state.pjaxData,e.state.pjaxConfig,!1),s("history",e.state.pjaxUrl,e.state))}function g(){if(!k){k=!1;var n=t.location+"",r=t.history.state;r&&r.pjaxUrl||H.replaceState({pjaxUrl:n,pjaxData:e.documentElement.outerHTML,pjaxConfig:N},e.title,n),t.addEventListener("unload",m),t.addEventListener("popstate",T),N.linkSelector&&e.addEventListener("click",S),N.formSelector&&e.addEventListener("submit",j)}}function y(){N&&k&&(e.removeEventListener("click",S),e.removeEventListener("submit",j),t.removeEventListener("unload",m),t.removeEventListener("popstate",T),k=!1,N=n)}function E(n){if(/^https?:$/.test(t.location.protocol)&&t.Pjax.supported){y(),N={linkSelector:"a:not([data-pjax-ignore]):not([href^='#']):not([href^='javascript:'])",formSelector:"form:not([data-pjax-ignore]):not([action^='javascript:'])",containers:["#pjax-container"],updatecurrent:!1,updatehead:!0,scrollLeft:0,scrollTop:0,nocache:!1,loader:!0,proxy:""};for(var r in N)n&&r in n&&(N[r]=n[r]);n=null,/^(interactive|complete)$/.test(e.readyState)?g():e.addEventListener("DOMContentLoaded",g)}}var M,N,b,D,H=t.history,O=t.URL,C=!!t.DOMParser,w={},U=e.implementation,P=t.location.protocol.replace(/:/g,"")+"://"+t.location.host,X=/^(input|textarea|select|datalist|button|output)$/i,k=!1,A=t.Element&&t.Element.prototype;if(t.Pjax={supported:!!(A&&H.pushState&&(C||U&&U.createHTMLDocument)),remove:y,start:E,request:function(e,t){x(e,t.replace?2:1,t.method,null,t.data)},on:function(e,t){u(e,t)},off:function(e,t){u(e,t,!0)}},C)try{var q=l("<html><head><title>1</title></head><body>1</body></html>");C=!!(q.head&&q.title&&q.body)}catch(F){C=!1}A&&!A.matches&&(A.matches=A.matchesSelector||A.mozMatchesSelector||A.msMatchesSelector||A.oMatchesSelector||A.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t[n]!==this;);return n>-1})}(document,window);
